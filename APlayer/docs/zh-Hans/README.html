<hr><h2 id=nav-zh-Hanssearch-zh-Hans><a title="nav: zh-Hanssearch: zh-Hans" class=headerlink href=#nav-zh-Hanssearch-zh-Hans></a>nav: zh-Hans<br>search: zh-Hans</h2><h1 id=APlayer><a class=headerlink href=#APlayer title=APlayer></a>APlayer</h1><p>🍭 Wow, such a beautiful HTML5 music player<h2 id=特别赞助商><a class=headerlink href=#特别赞助商 title=特别赞助商></a>特别赞助商</h2><a href=https://www.dogecloud.com/?ref=dplayer target=_blank> <img src=https://player.dogecloud.com/img/logo_with_product3.png width=222px> </a><h2 id=安装><a class=headerlink href=#安装 title=安装></a>安装</h2><p>使用 npm:<pre><code>npm install aplayer --save
</code></pre><p>使用 Yarn:<pre><code>yarn add aplayer
</code></pre><h2 id=入门><a class=headerlink href=#入门 title=入门></a>入门</h2><div class=aplayer-wrap><div id=aplayer2><button class="docute-button load">点击加载播放器 <pre><code class=html>&LTlink rel="stylesheet" href="APlayer.min.css">
&LTdiv id="aplayer">&LT/div>
&LTscript src="APlayer.min.js">&LT/script>
</code></pre> <pre><code class=js>const ap = new APlayer({
    container: document.getElementById('aplayer'),
    audio: [{
        name: 'name',
        artist: 'artist',
        url: 'url.mp3',
        cover: 'cover.jpg'
    }]
});
</code></pre> <p>使用模块管理器:</p> <pre><code class=js>import 'APlayer/dist/APlayer.min.css';
import APlayer from 'APlayer';

const ap = new APlayer(options);
</code></pre> <h2 id=参数><a class=headerlink href=#参数 title=参数></a>参数</h2><table><thead><tr><th>名称<th>默认值<th>描述<tbody><tr><td>container<td>document.querySelector(‘.aplayer’)<td>播放器容器元素<tr><td>fixed<td>false<td>开启吸底模式, <a href=https://aplayer.js.org/#/home?id=fixed-mode>详情</a><tr><td>mini<td>false<td>开启迷你模式, <a href=https://aplayer.js.org/#/home?id=mini-mode>详情</a><tr><td>autoplay<td>false<td>音频自动播放<tr><td>theme<td>‘#b7daff’<td>主题色<tr><td>loop<td>‘all’<td>音频循环播放, 可选值: ‘all’, ‘one’, ‘none’<tr><td>order<td>‘list’<td>音频循环顺序, 可选值: ‘list’, ‘random’<tr><td>preload<td>‘auto’<td>预加载，可选值: ‘none’, ‘metadata’, ‘auto’<tr><td>volume<td>0.7<td>默认音量，请注意播放器会记忆用户设置，用户手动设置音量后默认音量即失效<tr><td>audio<td>-<td>音频信息, 应该是一个对象或对象数组<tr><td>audio.name<td>-<td>音频名称<tr><td>audio.artist<td>-<td>音频艺术家<tr><td>audio.url<td>-<td>音频链接<tr><td>audio.cover<td>-<td>音频封面<tr><td>audio.lrc<td>-<td><a href=https://aplayer.js.org/#/home?id=lrc>详情</a><tr><td>audio.theme<td>-<td>切换到此音频时的主题色，比上面的 theme 优先级高<tr><td>audio.type<td>‘auto’<td>可选值: ‘auto’, ‘hls’, ‘normal’ 或其他自定义类型, <a href=https://aplayer.js.org/#/home?id=mse-support>详情</a><tr><td>customAudioType<td>-<td>自定义类型，<a href=https://aplayer.js.org/#/home?id=mse-support>详情</a><tr><td>mutex<td>true<td>互斥，阻止多个播放器同时播放，当前播放器播放时暂停其他播放器<tr><td>lrcType<td>0<td><a href=https://aplayer.js.org/#/home?id=lrc>详情</a><tr><td>listFolded<td>false<td>列表默认折叠<tr><td>listMaxHeight<td>-<td>列表最大高度<tr><td>storageName<td>‘aplayer-setting’<td>存储播放器设置的 localStorage key</table> <p>例如:</p> <div class=aplayer-wrap><div id=aplayer3><button class="docute-button load">点击加载播放器 <pre><code class=js>const ap = new APlayer({
    container: document.getElementById('player'),
    mini: false,
    autoplay: false,
    theme: '#FADFA3',
    loop: 'all',
    order: 'random',
    preload: 'auto',
    volume: 0.7,
    mutex: true,
    listFolded: false,
    listMaxHeight: 90,
    lrcType: 3,
    audio: [
        {
            name: 'name1',
            artist: 'artist1',
            url: 'url1.mp3',
            cover: 'cover1.jpg',
            lrc: 'lrc1.lrc',
            theme: '#ebd0c2'
        },
        {
            name: 'name2',
            artist: 'artist2',
            url: 'url2.mp3',
            cover: 'cover2.jpg',
            lrc: 'lrc2.lrc',
            theme: '#46718b'
        }
    ]
});
</code></pre> <h2 id=API><a class=headerlink href=#API title=API></a>API</h2><ul><li><p><code>APlayer.version</code>: 静态属性, 返回 APlayer 的版本号</p><li><p><code>ap.play()</code>: 播放音频</p><li><p><code>ap.pause()</code>: 暂停音频</p><li><p><code>ap.seek(time: number)</code>: 跳转到特定时间，时间的单位为秒</p> <pre><code class=js>ap.seek(100);
</code></pre><li><p><code>ap.toggle()</code>: 切换播放和暂停</p><li><p><code>ap.on(event: string, handler: function)</code>: 绑定音频和播放器事件，<a href=https://aplayer.js.org/#/home?id=event-binding>详情</a></p><li><p><code>ap.volume(percentage: number, nostorage: boolean)</code>: 设置音频音量</p> <pre><code class=js>ap.volume(0.1, true);
</code></pre><li><p><code>ap.theme(color: string, index: number)</code>: 设置播放器主题色, index 默认为当前音频的 index</p> <pre><code class=js>ap.theme('#000', 0);
</code></pre><li><p><code>ap.setMode(mode: string)</code>: 设置播放器模式，mode 取值应为 ‘mini’ 或 ‘normal’</p><li><p><code>ap.mode</code>: 返回播放器当前模式，’mini’ 或 ‘normal’</p><li><p><code>ap.notice(text: string, time: number, opacity: number)</code>: 显示通知，时间的单位为毫秒，默认时间 2000 毫秒，默认透明度 0.8，设置时间为 0 可以取消通知自动隐藏</p> <pre><code class=js>ap.notice('Amazing player', 2000, 0.8);
</code></pre><li><p><code>ap.skipBack()</code>: 切换到上一首音频</p><li><p><code>ap.skipForward()</code>: 切换到下一首音频</p><li><p><code>ap.destroy()</code>: 销毁播放器</p><li><p><code>ap.lrc</code></p> <ul><li><p><code>ap.lrc.show()</code>: 显示歌词</p><li><p><code>ap.lrc.hide()</code>: 隐藏歌词</p><li><p><code>ap.lrc.toggle()</code>: 显示/隐藏歌词</p></ul><li><p><code>ap.list</code></p> <ul><li><p><code>ap.list.show()</code>: 显示播放列表</p><li><p><code>ap.list.hide()</code>: 隐藏播放列表</p><li><p><code>ap.list.toggle()</code>: 显示/隐藏播放列表</p><li><p><code>ap.list.add(audios: array | object)</code>: 添加一个或几个新音频到播放列表</p></ul> <pre><code class=js>ap.list.add([{
    name: 'name',
    artist: 'artist',
    url: 'url.mp3',
    cover: 'cover.jpg',
    lrc: 'lrc.lrc',
    theme: '#ebd0c2'
}]);
</code></pre> <ul><li><code>ap.list.remove(index: number)</code>: 移除播放列表中的一个音频</ul> <pre><code class=js>ap.list.remove(1);
</code></pre> <ul><li><code>ap.list.switch()</code>: 切换到播放列表里的其他音频</ul> <pre><code class=js>ap.list.switch(1);
</code></pre> <ul><li><code>ap.list.clear()</code>: 清空播放列表</ul><li><p><code>ap.audio</code>: 原生 audio</p><li><p><code>ap.audio.currentTime</code>: 返回音频当前播放时间</p><li><p><code>ap.audio.duration</code>: 返回音频总时间</p><li><p><code>ap.audio.paused</code>: 返回音频是否暂停</p><li><p>支持大多数<a href=http://www.w3schools.com/tags/ref_av_dom.asp>原生audio接口</a></p></ul> <h2 id=事件绑定><a class=headerlink href=#事件绑定 title=事件绑定></a>事件绑定</h2><p><code>ap.on(event, handler)</code></p> <pre><code class=js>ap.on('ended', function () {
    console.log('player ended');
});
</code></pre> <p>音频事件</p> <ul><li>abort<li>canplay<li>canplaythrough<li>durationchange<li>emptied<li>ended<li>error<li>loadeddata<li>loadedmetadata<li>loadstart<li>mozaudioavailable<li>pause<li>play<li>playing<li>progress<li>ratechange<li>seeked<li>seeking<li>stalled<li>suspend<li>timeupdate<li>volumechange<li>waiting</ul> <p>播放器事件</p> <ul><li>listshow<li>listhide<li>listadd<li>listremove<li>listswitch<li>listclear<li>noticeshow<li>noticehide<li>destroy<li>lrcshow<li>lrchide</ul> <h2 id=歌词><a class=headerlink href=#歌词 title=歌词></a>歌词</h2><p>我们有三种方式来给 APlayer 传递歌词，使用 <code>lrcType</code> 参数指明使用哪种方式，然后把歌词放到 <code>audio.lrc</code> 参数或者 HTML 里。</p> <div class=aplayer-wrap><div id=aplayer4><button class="docute-button load">点击加载播放器 <h3 id=LRC-文件方式><a title="LRC 文件方式" class=headerlink href=#LRC-文件方式></a>LRC 文件方式</h3><p>第一种方式，把歌词放到 LRC 文件里，音频播放时会加载对应的 LRC 文件。</p> <pre><code class=js>const ap = new APlayer({
    container: document.getElementById('aplayer'),
    lrcType: 3,
    audio: {
        name: 'name',
        artist: 'artist',
        url: 'demo.mp3',
        cover: 'demo.jpg',
        lrc: 'lrc.lrc'
    }
});
</code></pre> <h3 id=JS-字符串方式><a title="JS 字符串方式" class=headerlink href=#JS-字符串方式></a>JS 字符串方式</h3><p>第二种方式，把歌词放到 JS 字符串里面。</p> <pre><code class=js>const ap = new APlayer({
    container: document.getElementById('aplayer'),
    lrcType: 1,
    audio: {
        name: 'name',
        artist: 'artist',
        url: 'demo.mp3',
        cover: 'demo.jpg',
        lrc: '[00:00.00]APlayer\n[00:04.01]is\n[00:08.02]amazing'
    }
});
</code></pre> <h3 id=HTML-方式><a title="HTML 方式" class=headerlink href=#HTML-方式></a>HTML 方式</h3><p>第三种方式，把歌词放到 HTML 里面。</p> <pre><code class=html>&LTlink rel="stylesheet" href="APlayer.min.css">
&LTdiv id="player">
    &LTpre class="aplayer-lrc-content">
        [00:00.00]APlayer audio1
        [00:04.01]is
        [00:08.02]amazing
        &LT!-- ... -->
    &LT/pre>
    &LTpre class="aplayer-lrc-content">
        [00:00.00]APlayer audio2
        [00:04.01]is
        [00:08.02]amazing
        &LT!-- ... -->
    &LT/pre>
&LT/div>
&LTscript src="APlayer.min.js">&LT/script>
</code></pre> <pre><code class=js>const ap = new APlayer({
    container: document.getElementById('aplayer'),
    lrcType: 2,
    audio: [[
        {
            name: 'name1',
            artist: 'artist1',
            url: 'url1.mp3',
            cover: 'cover1.jpg'
        },
        {
            name: 'name2',
            artist: 'artist2',
            url: 'url2.mp3',
            cover: 'cover2.jpg'
        }
    ]]
});
</code></pre> <h3 id=歌词格式><a class=headerlink href=#歌词格式 title=歌词格式></a>歌词格式</h3><p>支持下面格式的歌词：</p> <p><code>[mm:ss]APlayer</code></p> <p><code>[mm:ss.xx]is</code></p> <p><code>[mm:ss.xxx]amazing</code></p> <p><code>[mm:ss.xx][mm:ss.xx]APlayer</code></p> <p><code>[mm:ss.xx]&LTmm:ss.xx>is</code></p> <p><code>[mm:ss.xx]amazing[mm:ss.xx]APlayer</code></p> <h2 id=播放列表><a class=headerlink href=#播放列表 title=播放列表></a>播放列表</h2><p>当有多个音频时会 APlayer 会展示一个播放列表，<code>listFolded</code> 参数指明列表是否默认折叠，<code>listMaxHeight</code> 参数指明列表最大高度。</p> <div class=aplayer-wrap><div id=aplayer5><button class="docute-button load">点击加载播放器 <pre><code class=js>const ap = new APlayer({
    container: document.getElementById('player'),
    listFolded: false,
    listMaxHeight: 90,
    lrcType: 3,
    audio: [
        {
            name: 'name1',
            artist: 'artist1',
            url: 'url1.mp3',
            cover: 'cover1.jpg',
            lrc: 'lrc1.lrc',
            theme: '#ebd0c2'
        },
        {
            name: 'name2',
            artist: 'artist2',
            url: 'url2.mp3',
            cover: 'cover2.jpg',
            lrc: 'lrc2.lrc',
            theme: '#46718b'
        }
    ]
});
</code></pre> <h2 id=吸底模式><a class=headerlink href=#吸底模式 title=吸底模式></a>吸底模式</h2><p>APlayer 可以通过吸底模式固定在页面底部，这种模式跟普通模式有很大不同。</p> <div class=aplayer-wrap><div id=aplayer9><button class="docute-button load">点击加载播放器 <pre><code class=js>const ap = new APlayer({
    container: document.getElementById('player'),
    fixed: true,
    audio: [{
        name: 'name',
        artist: 'artist',
        url: 'url.mp3',
        cover: 'cover.jpg',
    }]
});
</code></pre> <h2 id=迷你模式><a class=headerlink href=#迷你模式 title=迷你模式></a>迷你模式</h2><p>如果你没有足够空间来放置正常模式的播放器，那么你可以考虑使用迷你模式。</p> <p>请注意迷你模式与吸底模式冲突。</p> <div class=aplayer-wrap><div id=aplayer6><button class="docute-button load">点击加载播放器 <pre><code class=js>const ap = new APlayer({
    container: document.getElementById('player'),
    mini: true,
    audio: [{
        name: 'name',
        artist: 'artist',
        url: 'url.mp3',
        cover: 'cover.jpg',
    }]
});
</code></pre> <h2 id=MSE-支持><a title="MSE 支持" class=headerlink href=#MSE-支持></a>MSE 支持</h2><h3 id=HLS><a class=headerlink href=#HLS title=HLS></a>HLS</h3><p>需要在 <code>APlayer.min.js</code> 前面加载 <a href=https://github.com/video-dev/hls.js>hls.js</a>。</p> <div class=aplayer-wrap><div id=aplayer7><button class="docute-button load">点击加载播放器 <pre><code class=html>&LTlink rel="stylesheet" href="APlayer.min.css">
&LTdiv id="aplayer">&LT/div>
&LTscript src="hls.min.js">&LT/script>
&LTscript src="APlayer.min.js">&LT/script>
</code></pre> <pre><code class=js>const ap = new APlayer({
    container: document.getElementById('aplayer'),
    audio: [{
        name: 'HLS',
        artist: 'artist',
        url: 'url.m3u8',
        cover: 'cover.jpg',
        type: 'hls'
    }]
});
</code></pre> <pre><code class=js>// 另一种方式，使用 customAudioType
const ap = new APlayer({
    container: document.getElementById('aplayer'),
    audio: [{
        name: 'HLS',
        artist: 'artist',
        url: 'url.m3u8',
        cover: 'cover.jpg',
        type: 'customHls'
    }],
    customAudioType: {
        'customHls': function (audioElement, audio, player) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(audio.url);
                hls.attachMedia(audioElement);
            }
            else if (audioElement.canPlayType('application/x-mpegURL') || audioElement.canPlayType('application/vnd.apple.mpegURL')) {
                audioElement.src = audio.url;
            }
            else {
                player.notice('Error: HLS is not supported.');
            }
        }
    }
});
</code></pre> <h2 id=根据封面自适应主题色><a class=headerlink href=#根据封面自适应主题色 title=根据封面自适应主题色></a>根据封面自适应主题色</h2><p>需要额外加载 <a href=https://github.com/lokesh/color-thief/blob/master/src/color-thief.js>color-thief.js</a></p> <div class=aplayer-wrap><div id=aplayer8><button class="docute-button load">点击加载播放器 <pre><code class=html>&LTlink rel="stylesheet" href="APlayer.min.css">
&LTdiv id="aplayer">&LT/div>
&LTscript src="APlayer.min.js">&LT/script>
&LTscript src="color-thief.js">&LT/script>
</code></pre> <pre><code class=js>const ap = new APlayer({
    container: document.getElementById('aplayer'),
    theme: '#e9e9e9',
    audio: [{
        name: 'name1',
        artist: 'artist1',
        url: 'url1.mp3',
        cover: 'cover1.jpg'
    }, {
        name: 'name2',
        artist: 'artist2',
        url: 'url2.mp3',
        cover: 'cover2.jpg'
    }]
});

const colorThief = new ColorThief();
const image = new Image();
const xhr = new XMLHttpRequest();
const setTheme = (index) => {
    if (!ap.list.audios[index].theme) {
        xhr.onload = function(){
            let coverUrl = URL.createObjectURL(this.response);
            image.onload = function(){
                let color = colorThief.getColor(image);
                ap.theme(`rgb(${color[0]}, ${color[1]}, ${color[2]})`, index);
                URL.revokeObjectURL(coverUrl)
            };
            image.src = coverUrl;
        }
        xhr.open('GET', ap.list.audios[index].cover, true);
        xhr.responseType = 'blob';
        xhr.send();
    }
};
setTheme(ap.list.index);
ap.on('listswitch', (index) => {
    setTheme(index);
});
</code></pre> <h2 id=CDN><a class=headerlink href=#CDN title=CDN></a>CDN</h2><ul><li><a href=https://www.jsdelivr.com/package/npm/aplayer>jsDelivr</a><li><a href=https://cdnjs.com/libraries/aplayer>cdnjs</a><li><a href=https://unpkg.com/aplayer/>unpkg</a></ul> <h2 id=常见问题><a class=headerlink href=#常见问题 title=常见问题></a>常见问题</h2><h3 id=为什么播放器不能在手机上自动播放？><a class=headerlink href=#为什么播放器不能在手机上自动播放？ title=为什么播放器不能在手机上自动播放？></a>为什么播放器不能在手机上自动播放？</h3><p>大多数移动端浏览器禁止了音频自动播放。</p>